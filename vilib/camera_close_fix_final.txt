    def camera_close():
        if Vilib.camera_thread != None:
            Vilib.camera_run = False
            time.sleep(0.1)
            # Wait for camera thread to finish
            if Vilib.camera_thread.is_alive():
                Vilib.camera_thread.join(timeout=2.0)
            
            # Properly close and reinitialize Picamera2
            try:
                if Vilib.picam2 is not None:
                    Vilib.picam2.close()
                    time.sleep(0.1)
                    
                # Recreate Picamera2 object completely fresh
                Vilib.picam2 = Picamera2()
                
                # Create and configure a default preview configuration
                preview_config = Vilib.picam2.create_preview_configuration()
                Vilib.picam2.configure(preview_config)
                
            except Exception as e:
                print(f"Warning during camera cleanup: {e}")
                # Force recreation of Picamera2 object with basic setup
                try:
                    Vilib.picam2 = Picamera2()
                    preview_config = Vilib.picam2.create_preview_configuration()
                    Vilib.picam2.configure(preview_config)
                except Exception as e2:
                    print(f"Failed to reinitialize camera: {e2}")
            
            # Reset thread reference
            Vilib.camera_thread = None
